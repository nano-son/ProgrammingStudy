## TCP/IP 스터디
### 정의


>네트워크에 연결되어 있는 컴퓨터끼리 통신을 하기 위한
절차 및 규칙들의 모음이다.


### TCP/IP 탄생 배경

밥 칸이 NCP라는 무선통신 환경을 대상으로 하는 프로토콜을 개발하였다. 이 프로토콜의 문제점은 기존에 구성된 기계 이외에는 네트워크에 참여할 수 없기에 자율적인 확장을 생각했던 인터넷의 개념과는 맞지 않았다.
각각의 네트워크는 독립적으로 유지되면서 네트워크 간의 네트워크인 인터넷에 접속될 때 특별한 변화나 조작이 없어야 했다.

빈트 서프이라는 사람과 밥 칸이 합작하여 인터넷 기기들의 소통언어라고 할 수 있는 TCP/IP 프로토콜을 설계하였다.



### IPv4

 IP주소의 길이는 4Byte(32Bit)이다. 따라서 전 세계 IP주소의 총 갯수는 2의 32개 42억개 정도가 된다. IP 주소는 1바이트당 점으로 구분한다.

#### 클래스

 이 주소는 총 5개의 클래스로 나뉜다. 42억개를 차례대로 절반씩 나눠가진다. A클래스는 21억개, 나머지는 B,C,D,E 가지는 식이다.

<pre>
000000000000000.... -- A
100000000000000.... -- B
110000000000000.... -- C
...
</pre>
이런 식으로 클래스를 나눌 수 있다. 따라서 IP주소에서는 이런 식으로 나뉘어 진다.
<pre>
0~127 -- A
128~191 --B
192~223 --C
...
</pre>
왜냐면 A클래스를 예를 들었을 때 맨 앞의 1바이트의 주소를 보았을 때 맨 앞 자리가 0이면 절대 127을 넘을 수 없기 떄문이다. 마찬가지로 B클래스는 맨 앞자리가 1이면 128보다 적을 수 없고 두번째 자리가 0이므로 191을 넘을 수 없다.


#### netid, hostid
앞에서 말했듯이 IP 주소는 1바이트씩 점으로 구분되는데 이 점을 기준으로

<pre>
Netid | Hostid | Hostid | Hostid -- A
Netid | Netid | Hostid | Hostid  -- B
Netid | Netid | Netid | Hostid  -- C
</pre>

이런 식으로 각각의 클래스들의 IP주소는 Netid와 Hostid로 나뉘어져 있다. 사람의 성과 이름 같은 기능으로 IP 주소의 유일성을 보장하려고 만들어놨나보다.


### 서브넷팅

> 서브넷팅이 안되어 있으면 내가  A클래스에 데이터를 던지면 목적지 컴퓨터가 아닌 수 많은 컴퓨터들은 다 데이터를 버려야 할 것이다. 이런걸 방지하기 위해서 서브넷팅을 한다.


네트워크가 4개의 서브네트워크로 나뉘어졌다치자. 그럼 각각의 서브네트워크는 몇번을 할당 받을까?
256을 두개로 나누고 0~127/128~256 또 각각을 두개로 나뉘면 0~63/64~127/128~191/192~255 로 나눌 수 있다. 이를 이진수로 표현하면 앞자리가 00/01/10/11 이라는 규칙으로 나뉘어 진다는 것을 알 수 있다.


여기서 00/01/10/11 을 걸어주는 서브넷마스크를 사용해서 서브네트워크 주소를 알 수 있다.




### 4계층

>각 계층은 인접한 계층끼리 작용하고 작용할 시 캡슐화를 진행하여 각 계층의 기능에 맞는 header/tail을 패킷에 붙힌다.

|층 | 계층 이름 |  기능|
|------- | ---------------- | ---------- |
|1  | Application      |   흔히 사용자가 사용하는 소프트웨어가 실행 되는 계층|
|2  | Transport(TCP)        | TCP 전송과 통제를 하는 계층, App 계층에서 받은 데이터를 논리적인 데이터의 조각인 Segment로 나눈다. Segment들은 번호를 부여받게 되고 수신측은 이 번호를 활용하여 전송 받은 Segment들을 재조합한다.       |
|3   | Internet(IP)          | 주소 배정과 경로 선택을 주 역할로 한다. TCP 계층에서 받은 데이터를 패킷이라는 단위로 처리한다. 패킷은 헤더와 데이터로 구성되어 있다. 이 패킷은 목적지 네트워크가 어디고 상위의 어떤 프로토콜과 관련이 있는지 말해준다.|
|4 | Physical            |  위에서 만들어진 데이터를 Network Interface에 맞게 재포장하고 수신 할 때에는 인터페이스에서 날아온 데이터를 다시 상위 레이어에 맞는 형식으로 변환하는 역할을 한다.|


### 게이트웨이

>IP가 집주소라고 한다면 게이트웨이는 발신지 혹은 수신지 구역을 담당하는 우체국 같은 요소인 것 같다.
발신 측에서 패킷을 전송 할 때 해당 게이트웨이를 지나고 수신측에서 패킷을 받을 때도 마찬가지로 해당 게이트웨이를 지나 오게 된다.


### DNS 서버

>www.naver.com = 221.218.150.200
이런 정보를 저장하고 있는 서버라고 생각하면 될 것 같다.
사용자는 주소를 기억하기 쉽고 컴퓨터는 그런 사용자가 기억하고 있는 주소를 다시 IP주소로 받아 사용한다.



### DHCP(Dynamic Host Configuration Protocol)

DHCP를 사용 안하면 인터넷에 접속할 때 손으로 IP를 넣어주어야하고 다른 네트워크로 이동하였을 때 새로 넣어줘야한다. 하지만 DHCP를 사용한다면 네트워크 관리자들이 동적으로 IP 주소를 할당해주기 떄문에 자동으로 새로운 IP 주소를 보내준다.


#### DHCP 동작원리

1. DHCP Discover (단말->DHCP 서버) : 
단말기가 서버에게 아이피 주소 할당을 요청

2. DHCP Offer (DHCP서버 -> 단말)
브로드캐스트나 유니캐스트를 통해 단말에게 아이피 주소 정보를 포함한 네트워크 정보의 할당 요청을 응답 하는 것이다.

3. DHCP Request(단말 -> DHCP서버)
브로드캐스트 메세지로 단말이 받은 아이피 주소 정보를 사용하겠다는 메세지

4. DHCP ACK(DHCP서버 -> 단말)
단말에서 보낸 DHCP Request 메세지 내의 Brodcast Flag 가 1이면 브로드캐스트로 0이면 유니캐스트로 보내주며 단말의 MAC 어드레스에 매치되는 IP 주소와 게이트웨이 주소를 확정하여 주는 것이다.


### 공인 IP vs 사설 IP

1)  공인 IP  주소
- ISP 업체에서 할당한 인터넷이 가능한 주소
- 공인 IP 네트워크 정보는 ISP 업체 라우터 장비에 등록  O

2) 사설 IP 주소
- ISP 업체 임대와 관계 없이 내부용으로 사용하는 주소
- 사설 IP 네트워크 정보는 ISP 업체 라우터 장비에 등록 X

<pre>
10.0.0.0 ~ 10.255.255.255 -- A
172.16.0.0 ~ 172.31.255.255 -- B
192.168.0.0 ~ 192.168.255.255 -- C
</pre> 






